# SPLCrypt Unpacker

Unpacker for SPLCrypt that uses Mandiant Speakeasy bin emulator. In addition to the requirements in requirements.txt, speakeasy must be installed. Speakeasy can be found here: https://github.com/mandiant/speakeasy

## Usage

usage: unpack.py [-h] -f FILE -o OUTFILE

SPLCrypt Unpacker unpacker

optional arguments:
  -h, --help            show this help message and exit
  -f FILE, --file FILE  Path of file to unpack
  -o OUTFILE, --outfile OUTFILE
                        Path to save unpacked file


## Output

* exec: dll_entry.DLL_PROCESS_ATTACH
* exec: export.AmSiU9nmwiht
* exec: export.EproyAklW
[*] RtlAllocateHeap Called! Recording allocated memory.
0x180003f97: 'ntdll.RtlAllocateHeap(0x0, 0x8, 0x265c8)' -> 0x28000
[*] RtlAllocateHeap Called! Recording allocated memory.
0x1800017b5: 'ntdll.RtlAllocateHeap(0x0, 0x8, 0x132e4)' -> 0x51000
[*] RtlAllocateHeap Called! Recording allocated memory.
0x180002009: 'ntdll.RtlAllocateHeap(0x0, 0x8, 0x8)' -> 0x84f0
[*] RtlAllocateHeap Called! Recording allocated memory.
0x1800020cd: 'ntdll.RtlAllocateHeap(0x0, 0x8, 0x1cf14)' -> 0x75000
0x180001f8f: 'ntdll.RtlFreeHeap(0x0, 0x0, 0x84f0)' -> 0x1
0x180004218: 'ntdll.NtCreateSection(0x280, 0xf001f, 0x0, 0x1211d78, 0x1cf1400000040, 0xffffffff08000000, 0x0)' -> 0x0
0x180004132: 'ntdll.NtMapViewOfSection(0x280, 0xffffffffffffffff, 0x9000, 0x0, 0x0, 0x0, 0x1000, 0x100000001, 0x0, 0x40)' -> 0x0
[*] NtClose CALLED! Dumping memory from allocated regions.
[*] Searching for PE in allocated memory regions
[*] Searching for PE in allocated memory regions
[*] Searching for PE in allocated memory regions
[*] Searching for PE in allocated memory regions
  [*] Found PE file at offset 0xD0F
[*] PE Found in allocated memory
[*] Writing PE: spl_unpacked.dll
0x1800040f6: 'ntdll.NtClose(0x280)' -> None

file spl_unpacked.dll       
spl_unpacked.dll: PE32+ executable (DLL) (GUI) x86-64, for MS Windows

